-- вывести все данные из таблиц
use Polyclinic
select * from Doctor
select * from Passport
select * from Patient
select * from Speciality
select * from Visit
select * from Diagnosis

-- вывести определенные данные, отсортированные в алфавитном порядке по 
-- определенному полю
select * from Doctor
order by DName

-- вывести  определенные  данные,  отсортированные  в  обратном  алфавитном 
-- порядке по двум полям
select * from Doctor
order by DSurname DESC, DName DESC

-- создать вычисляемое поле, и вывести данные, убрав дубликаты
select DISTINCT DSurname + ' ' + DName + ' ' + DMName as FIO from Doctor

-- вывести 30% строк
SELECT TOP 30 PERCENT *
FROM Patient

--вывести первые 5 строк
select TOP 5 * from Patient

--вывести строки начиная с 4 строки по 7 строку, отсортированные в обратном 
--порядке
SELECT *
    FROM Patient
    ORDER BY
    FIO
    OFFSET 3 ROWS
    FETCH NEXT 4 ROWS ONLY

--Отсортировать данные, используя в   качестве критерия сортировки сложно 
--выражение на основе столбцов
select * from Doctor
order by DSurname + ' ' + DName + ' ' + DMName

-- Запрос на выборку с добавлением SELECT INTO
SELECT DSurname + ' ' + DName + ' ' + DMName AS FIO, DBirth_Date
INTO Doctors_birthdays
FROM Doctor
SELECT * FROM Doctors_birthdays

-- 4. С помощью языка T-SQL написать и выполнить 7 запросов на фильтрацию данных 
-- с использованием в запросах операторов сравнения, логических операторов


-- 5. Переименуйте одну из таблиц вашей БД
use Polyclinic
exec sp_rename 'Doctor', 'List_Doctors'

-- 6. Добавьте по две записи в каждую из таблиц вашей БД


-- 7. добавьте по смыслу один столбец
use TestDatabas;
Alter Table dbo.Klient_alt
Add Adress NVARCHAR(50) NULL;

use TestDatabas;
Alter table dbo.klient_alt
drop column Phone

-- добавьте ограничение с именем на новый введенный вами столбец
Alter Table dbo.Zakaz
ADD CONSTRAINT FK_Zakaz_TO_Klient_Alt
Foreign Key(KlientID) REFERENCES Klient_alt(Id);

use TestDatabas;
exec sp_help Zakaz

-- 8. Напишите  5  запросов,  используя  агрегатные  функции  (SUM,  MAX,  MIN,  AVG, 
-- COUNT)


-- 9. Написать 2 запроса на группировку данных, используя оператор GROUP BY


-- 10.  Написать 2 запроса на фильтрацию групп, используя HAVING.


-- 11. Написать запросы на расширения SQL Server для группировки (ROLLUP, CUBE, GROUPING SETS, OVER)


-- 12. Написать  запрос  на  разворачивание  данных (PIVOT),  отмена  разворачивания 
-- (UNPIVOT).


-- 13. Написать  по два запроса на каждое соединение  таблиц:  внутреннее,  внешнее 
-- левое, внешнее правое, полное внешнее  соединение.

-- 14. Написать по два запроса на пересечение, разность, объединение таблиц


-- 15. Написать 4 запроса с использованием подзапросов, используя операторы сравнения, 
-- операторы IN, ANY|SOME и ALL,  предикат EXISTS

--16.  Написать 4 запроса по строковым функциям


-- 17.  Написать 4 запроса по числовым функциям


-- 18. Создайте 5 представлений по своей БД


-- 19.  Покажите применение табличных переменных, временные локальных и глобальных 
-- таблиц, а так же обобщенных табличных выражений. 